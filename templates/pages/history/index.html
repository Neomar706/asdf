{% extends 'base.html' %}


{% block title %}
Youtube
{% endblock title %}

{% block extra_head %}
{% endblock extra_head %}

{% block modal %}
<div id="modal">
</div>
{% endblock modal %}

{% block navbar %}
{% include 'components/navbar.html' with avatar_url=avatar_url %}
{% endblock navbar %}

{% block content %}
<div class='flex text-white mt-14'>

    {% include 'components/sidebar.html' %}

    <div :class='$store.global.sidebar.show ? "ml-60" : "ml-20"' class="flex flex-col flex-1 overflow-x-hidden h-content">
        <div class="mx-4">
            <h1 class="text-4xl font-bold py-10">Historial de reproducciones</h1>
            <div class="flex">
                {% if history %}
                <div class="w-2/3">
                    {% for videos_his in history %}
                    <span class="text-xl font-bold inline-block mt-8 mb-4">
                        {{ videos_his.moment }}
                    </span>
                    {% include "pages/history/components/card.html" %}
                    {% endfor %}
                </div>
                {% else %}
                <div class="w-2/3">
                    <div class="mt-32 flex justify-center text-xl font-semibold text-zinc-400">
                        No se encontraron resultados
                    </div>
                </div>
                {% endif %}
                <div class="w-1/3 relative">
                    <div class="fixed w-[25rem] mx-auto flex flex-col">
                        <div x-data="{value: ''}" class="w-2/3 border-b border-white/75">
                            <form action="{% url 'history:main' %}" method="GET" class="relative">
                                <input x-model="value" name="query" type="text" placeholder="Buscar en el historial" class="w-full bg-transparent outline-none border-none px-10 autofill:bg-transparent">
                                <button @click="!value.length && $event.preventDefault()" type="submit" class="w-10 h-10 flex items-center justify-center absolute left-0 top-0 rounded-full hover:bg-cgray-600 cursor-pointer">
                                    <div class="w-6 h-6">
                                        <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;">
                                            <path fill="white" d="m20.87 20.17-5.59-5.59C16.35 13.35 17 11.75 17 10c0-3.87-3.13-7-7-7s-7 3.13-7 7 3.13 7 7 7c1.75 0 3.35-.65 4.58-1.71l5.59 5.59.7-.71zM10 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"></path>
                                        </svg>
                                    </div>
                                </button>
                                <button @click="value = ''" type="button" class="w-10 h-10 rounded-full hover:bg-cgray-600 flex items-center justify-center absolute right-0 top-0 cursor-pointer">
                                    <div class="w-6 h-6">
                                        <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;">
                                            <path fill="white" d="m12.71 12 8.15 8.15-.71.71L12 12.71l-8.15 8.15-.71-.71L11.29 12 3.15 3.85l.71-.71L12 11.29l8.15-8.15.71.71L12.71 12z"></path>
                                        </svg>
                                    </div>
                                </button>
                            </form>
                        </div>
                        <div class="flex flex-col gap-2 my-4">
                            <button 
                                @click="$store.global.showModal = true"
                                hx-get="{% url 'history:clear' %}"
                                hx-target="#modal"
                                hx-swap="outerHTML"
                                class="hover:bg-cgray-600 px-3.5 py-1.5 rounded-full font-semibold text-sm w-fit flex items-center gap-2"
                            >
                                <div class="w-6 h-6">
                                    <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;">
                                        <path fill="white" d="M11 17H9V8h2v9zm4-9h-2v9h2V8zm4-4v1h-1v16H6V5H5V4h4V3h6v1h4zm-2 1H7v15h10V5z"></path>
                                    </svg>
                                </div>
                                Borrar todo el historial de reproducciones
                            </button>
                            {% if channel.is_paused_history %}
                            <form action="{% url 'history:toggle-pause' %}" method="POST">
                                {% csrf_token %}
                                <button class="hover:bg-cgray-600 px-3.5 py-1.5 rounded-full font-semibold text-sm w-fit flex items-center gap-2">
                                    <div class="w-6 h-6">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%; margin-top: -6px; margin-left: -4px">
                                            <path fill="white" class="ytp-svg-fill" d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z" id="ytp-id-51"></path>
                                        </svg>
                                    </div>
                                    Despausar el historial de reproducciones
                                </button>
                            </form>
                            {% else %}
                            <button 
                                @click="$store.global.showModal = true"
                                hx-get="{% url 'history:toggle-pause' %}"
                                hx-target="#modal"
                                hx-swap="outerHTML"
                                class="hover:bg-cgray-600 px-3.5 py-1.5 rounded-full font-semibold text-sm w-fit flex items-center gap-2"
                            >
                                <div class="w-6 h-6">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;">
                                        <path fill="white" d="M9 19H7V5h2Zm8-14h-2v14h2Z"></path>
                                    </svg>
                                </div>
                                Pausar el historial de reproducciones
                            </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock content %}

{% block footer %}
{% endblock footer %}

{% block javascript %}
{% endblock javascript %}